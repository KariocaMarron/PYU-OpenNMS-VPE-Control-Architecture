services:
  minion:
    image: opennms/minion:33.0.2
    container_name: hamhung-minion
    hostname: hamhung-minion
    environment:
      MINION_ID: hamhung-minion-01
      MINION_LOCATION: Hamhung
      OPENNMS_HTTP_URL: http://pyu-horizon:8980/opennms
      OPENNMS_HTTP_USER: admin
      OPENNMS_HTTP_PASS: admin
      OPENNMS_IPC_STRATEGY: kafka
      OPENNMS_KAFKA_BOOTSTRAP_SERVERS: pyu-kafka:9092
    command: ["-c"]
    entrypoint: ["/opt/minion-startup.sh"]
    volumes:
      - hamhung-minion-data:/opt/minion-data
      - ./hamhung-custom.properties:/opt/minion/etc/custom.properties:ro
      - ./minion-startup.sh:/opt/minion-startup.sh:ro
    ports:
      - "8201:8201/tcp"
      - "1162:1162/udp"
      - "1514:1514/udp"
    networks:
      - hamhung-campus
      - horizon_pyu-main

  router:
    image: alpine:latest
    container_name: hamhung-router
    command: sleep infinity
    networks:
      - hamhung-campus

  web:
    image: nginx:alpine
    container_name: hamhung-web
    volumes:
      - ./hamhung-web-content:/usr/share/nginx/html:ro
    networks:
      - hamhung-campus

  dns:
    image: strm/dnsmasq
    container_name: hamhung-dns
    networks:
      - hamhung-campus

volumes:
  hamhung-minion-data:

networks:
  hamhung-campus:
    driver: bridge
  horizon_pyu-main:
    external: true

#Jose Vasconcelos - Dec 2025
#acme5bataj10@outlook.com
